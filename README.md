# Simple Mouse Gesture (MV3)

Open-source Chrome mouse gesture extension with configurable actions. Defaults are minimal and safe; configuration is editable in the Options page with import/export support.

> Extension display name in Chrome: "MouseGestureSpeed"

## Features
- Simple, low-latency gestures using the 4 cardinal directions
- Default gesture set for navigation, scrolling, reload, and close tab
- Options page for editing, importing, and exporting JSON configuration
- Modular MV3 architecture with background/content separation, typed messaging, and logging

## Installation

You can load either the project root (uses the included `dist/` build) or the `dist/` folder (uses a post-built manifest with adjusted paths).

- Prerequisites: Chrome/Chromium-based browser with Manifest V3 support

Option A — Load unpacked (prebuilt)
1. Open `chrome://extensions`
2. Enable "Developer mode"
3. Click "Load unpacked" and select the repository root folder (or the `dist/` folder)
4. Ensure the service worker registers without errors

Option B — Build from source
1. Install dependencies: `npm install`
2. Build: `npm run build`
3. Load unpacked: point to the repository root (or `dist/`)

Recommended during development: `npm run build:watch` for incremental builds in a separate terminal.

## Default Gestures

- LEFT → Navigate back
- RIGHT → Navigate forward
- UP → Scroll to top
- DOWN → Scroll to bottom
- DOWN > UP → Reload page
- RIGHT_BUTTON > LEFT_CLICK → Close current tab


## Permissions and Behavior

- `tabs`, `scripting`, `activeTab`, `storage` are requested for routing actions, injecting content when needed, and persisting settings
- `host_permissions: ["<all_urls>"]` allow gestures on most pages; Chrome-restricted URLs (e.g., `chrome://`, `edge://`, `about:`, `devtools:`) are excluded by design
- Auto-injection: the background script can activate content on pages when host permission exists
- Manual activation: clicking the toolbar icon may request permission for the current origin and attempt injection

## Configuration

Open the extension's Options page to customize:
- Global settings: `defaultDelay` (ms) and `minMoveDistance` (px)
- Gesture list: add/remove gestures, edit sequences and actions
- Import/Export JSON: backup and share your configuration
- Restore defaults: revert to the bundled configuration in `config/gestures.json`

Schema (example):
```json
{
  "defaultDelay": 100,
  "minMoveDistance": 10,
  "gestures": [
    { "sequence": ["LEFT"], "action": "NAVIGATE_BACK" },
    { "sequence": ["RIGHT"], "action": "NAVIGATE_FORWARD" },
    { "sequence": ["UP"], "action": "SCROLL_TOP" },
    { "sequence": ["DOWN"], "action": "SCROLL_BOTTOM" },
    { "sequence": ["DOWN", "UP"], "action": "RELOAD" },
    { "sequence": ["RIGHT_BUTTON", "LEFT_CLICK"], "action": "CLOSE_TAB" }
  ]
}
```

- Directions: `UP`, `DOWN`, `LEFT`, `RIGHT`, `RIGHT_BUTTON`, `LEFT_CLICK`
- Actions: `NAVIGATE_BACK`, `NAVIGATE_FORWARD`, `SCROLL_TOP`, `SCROLL_BOTTOM`, `RELOAD`, `CLOSE_TAB`

## How It Works

- Content script
  - Tracks pointer events after a right-button press
  - Converts movement into direction sequences (with minimal distance threshold)
  - Interprets sequences against the active configuration
  - Dispatches DOM actions directly or forwards privileged actions to the background
- Background service worker
  - Receives gesture actions requiring extension privileges (e.g., close tab)
  - Handles light auto/multi-step content injection based on host permissions
  - Caches configuration for quick responses and telemetry logging
- Options page
  - Provides a simple UI to edit gestures and global parameters
  - Validates configuration, supports import/export, and restores defaults

Logging: each module uses a tagged logger (e.g., `[GestureTracker]`, `[ActionRouter]`). You can set log level programmatically via `setLogLevel('info' | 'error' | 'silent')` inside devtools if needed.

## Project Structure

- `src/common/` — Types, validation, logging, messaging, configuration state
- `src/content/` — Gesture tracker, interpreter, router, and entrypoint
- `src/background/` — Service worker entry and privileged action executor
- `src/options/` — Options page logic (vanilla DOM)
- `config/gestures.json` — Default gesture configuration
- `dist/` — Compiled JS and release-ready assets (generated by `npm run build`)

Key scripts:
- `npm run build` — Compile TypeScript and copy/adjust assets into `dist/`
- `npm run build:watch` — Watch-mode TypeScript build
- `npm run typecheck` — Type-only compilation
- `npm run package` — Build then create a release zip under `release/`

## Packaging

- Run: `npm run package`
- Output: `release/<name>-<version>.zip` containing the built extension (with `manifest.json` at archive root)

## Troubleshooting

- Gestures do not work on certain pages
  - Chrome restricts extensions on some URL schemes (e.g., `chrome://`, `edge://`, `about:`, `devtools:`)
- Content not active on a site
  - Click the extension toolbar icon to request host permission and inject the content script
- Right-click context menu still appears
  - Ensure you hold the right button long enough; the context menu is suppressed only after a completed gesture
- No action after gesture
  - Check the console for logs in the page (content) and in `chrome://extensions` service worker (background)


## Roadmap

- Optional overlay for live gesture feedback
- Additional actions and per-site overrides
- Settings for log level in Options page
